

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>afterglow.trackers &mdash; afterglow 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="afterglow.enable" href="enable.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> afterglow
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Package Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="enable.html">afterglow.enable</a><ul>
<li class="toctree-l2"><a class="reference internal" href="enable.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="enable.html#module-afterglow.enable.base">afterglow.enable.base module</a></li>
<li class="toctree-l2"><a class="reference internal" href="enable.html#module-afterglow.enable.offline">afterglow.enable.offline module</a></li>
<li class="toctree-l2"><a class="reference internal" href="enable.html#module-afterglow.enable.online">afterglow.enable.online module</a></li>
<li class="toctree-l2"><a class="reference internal" href="enable.html#module-afterglow.enable">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">afterglow.trackers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-afterglow.trackers.batchnorm">afterglow.trackers.batchnorm module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-afterglow.trackers.trackers">afterglow.trackers.trackers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-afterglow.trackers">Module contents</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">afterglow</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>afterglow.trackers</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/modules/trackers.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="afterglow-trackers">
<h1>afterglow.trackers<a class="headerlink" href="#afterglow-trackers" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-afterglow.trackers.batchnorm">
<span id="afterglow-trackers-batchnorm-module"></span><h2>afterglow.trackers.batchnorm module<a class="headerlink" href="#module-afterglow.trackers.batchnorm" title="Permalink to this headline">¶</a></h2>
<p>Adapted from torch.optim.swa_utils</p>
<dl class="py function">
<dt class="sig sig-object py" id="afterglow.trackers.batchnorm.update_bn">
<span class="sig-prename descclassname"><span class="pre">afterglow.trackers.batchnorm.</span></span><span class="sig-name descname"><span class="pre">update_bn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loader</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.utils.data.dataloader.DataLoader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.nn.modules.module.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">torch.device</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_datapoints</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/afterglow/trackers/batchnorm.html#update_bn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#afterglow.trackers.batchnorm.update_bn" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates BatchNorm running_mean, running_var buffers in the model.</p>
<p>It performs one pass over data in <cite>loader</cite> to estimate the activation
statistics for BatchNorm layers in the model.
:param loader: dataset loader to compute the</p>
<blockquote>
<div><p>activation statistics on. Each data batch should be either a
tensor, or a list/tuple whose first element is a tensor
containing data.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – model for which we seek to update BatchNorm
statistics.</p></li>
<li><p><strong>device</strong> – If set, data will be transferred to
<code class="xref py py-attr docutils literal notranslate"><span class="pre">device</span></code> before being passed into <code class="xref py py-attr docutils literal notranslate"><span class="pre">model</span></code>.</p></li>
<li><p><strong>num_datapoints</strong> – number of examples to use to perform the update.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span><span class="p">,</span> <span class="n">model</span> <span class="o">=</span> <span class="o">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">swa_utils</span><span class="o">.</span><span class="n">update_bn</span><span class="p">(</span><span class="n">loader</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <cite>update_bn</cite> utility assumes that each data batch in <code class="xref py py-attr docutils literal notranslate"><span class="pre">loader</span></code>
is either a tensor or a list or tuple of tensors; in the latter case it
is assumed that <code class="xref py py-meth docutils literal notranslate"><span class="pre">model.forward()</span></code> should be called on the first
element of the list or tuple corresponding to the data batch.</p>
</div>
</dd></dl>

</div>
<div class="section" id="module-afterglow.trackers.trackers">
<span id="afterglow-trackers-trackers-module"></span><h2>afterglow.trackers.trackers module<a class="headerlink" href="#module-afterglow.trackers.trackers" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="afterglow.trackers.trackers.CheckpointTracker">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">afterglow.trackers.trackers.</span></span><span class="sig-name descname"><span class="pre">CheckpointTracker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.nn.modules.module.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_iteration</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_period_in_iters</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_dir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.9)"><span class="pre">pathlib.Path</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/afterglow/trackers/trackers.html#CheckpointTracker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#afterglow.trackers.trackers.CheckpointTracker" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Records model state throughout training.</p>
<p>This class is intended for convenient offline swag enabling, see
<code class="code docutils literal notranslate"><span class="pre">afterglow.enable.offline.enable_swag_from_checkpoints</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>module</strong> – module to enable tracking for.</p></li>
<li><p><strong>start_iteration</strong> – iteration from which to begin recording snapshots.</p></li>
<li><p><strong>update_period_in_iters</strong> – how often to observe the parameters, in interations</p></li>
<li><p><strong>checkpoint_dir</strong> – directory in which to store the snapshots.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="afterglow.trackers.trackers.SWAGTracker">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">afterglow.trackers.trackers.</span></span><span class="sig-name descname"><span class="pre">SWAGTracker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.nn.modules.module.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_iteration</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pydantic.types.StrictInt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cols</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">afterglow.trackers.trackers.ConstrainedIntValue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_period_in_iters</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pydantic.types.StrictInt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_for_batchnorm</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.utils.data.dataloader.DataLoader</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_datapoints_for_bn_update</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pydantic.types.StrictInt</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/afterglow/trackers/trackers.html#SWAGTracker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#afterglow.trackers.trackers.SWAGTracker" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Models the parameter distribution over the training trajectory as a multivariate
gaussian in a low-rank space. See SWAG paper: <a class="reference external" href="https://arxiv.org/abs/1902.02476">https://arxiv.org/abs/1902.02476</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>module</strong> – module to enable tracking for.</p></li>
<li><p><strong>start_iteration</strong> – iteration from which to begin fitting the approx posterior.</p></li>
<li><p><strong>max_cols</strong> – the posterior covariance matrix is dimensionally reduced to this
dimensionality. Must be greater than 1.</p></li>
<li><p><strong>update_period_in_iters</strong> – how often to observe the parameters, in interations</p></li>
<li><p><strong>dataloader_for_batchnorm</strong> – if this is is provided, we update the model’s
batchnorm running means and variances every time we sample a new set of
parameters using the data in the dataloader. This is slow but can improve
performance significantly. See SWAG paper, and
<code class="code docutils literal notranslate"><span class="pre">torch.optim.swa_utils.update_bn</span></code>. Note that the
assumptions made about what iterating over the dataloader returns are
the same as those in <code class="code docutils literal notranslate"><span class="pre">torch.optim.swa_utils.update_bn</span></code>: it’s
assumed that iterating produces a sequence of (input_batch, label_batch)
tuples.</p></li>
<li><p><strong>num_datapoints_for_bn_update</strong> – Number of training example to use to perfom the
batchnorm update.
If <code class="code docutils literal notranslate"><span class="pre">None</span></code>, we use the whole dataset, as in the original SWAG
paper. It’s better to better to set this value to 1 and increase the
number of SWAG samples drawn when predicting in online mode
(one example at a time) rather than in batch mode.
If this is not None, dataloader_for_batchnorm must be
initialised with <code class="code docutils literal notranslate"><span class="pre">shuffle=True</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="afterglow.trackers.trackers.SWAGTracker.predict_uncertainty">
<span class="sig-name descname"><span class="pre">predict_uncertainty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pydantic.types.StrictInt</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_key</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/afterglow/trackers/trackers.html#SWAGTracker.predict_uncertainty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#afterglow.trackers.trackers.SWAGTracker.predict_uncertainty" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict mean and standard deviation of predictive distribution
when model inputs are <code class="code docutils literal notranslate"><span class="pre">args</span></code>, <code class="code docutils literal notranslate"><span class="pre">kwargs</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – positional arguments to pass to the model</p></li>
<li><p><strong>**kwargs</strong> – keyword arguments to pass to the model</p></li>
<li><p><strong>num_samples</strong> – number of samples to draw</p></li>
<li><p><strong>dropout</strong> – whether to use mc-dropout estimation together
with SWAG when sampling</p></li>
<li><p><strong>prediction_key</strong> – if the model returns a dict, this specifices
which key contains its predictions; uncertainty will be computed
using the contents of this key. Must be provided if the model
returns a dict, otherwise ignored.</p></li>
<li><p><strong>device</strong> – device on which the model lives. Only
needed for the batchnorm update step, ignored if
this doesn’t happen. “cpu” by default.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mean and standard deviation of the predictive distribution
at the inputs <code class="code docutils literal notranslate"><span class="pre">args</span></code>, <code class="code docutils literal notranslate"><span class="pre">kwargs</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="afterglow.trackers.trackers.SWAGTracker.predict_uncertainty_on_dataloader">
<span class="sig-name descname"><span class="pre">predict_uncertainty_on_dataloader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pydantic.types.StrictInt</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_key</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_unreduced_minibatches</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/afterglow/trackers/trackers.html#SWAGTracker.predict_uncertainty_on_dataloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#afterglow.trackers.trackers.SWAGTracker.predict_uncertainty_on_dataloader" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict the mean and standard deviation of the model’s output
distribution on the examples contained in <code class="code docutils literal notranslate"><span class="pre">dataloader</span></code>. We assume
that dataloader returns (input_batch, label_batch) tuples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataloader</strong> – contains the examples to sample from the output
distribution on</p></li>
<li><p><strong>num_samples</strong> – number of samples to draw</p></li>
<li><p><strong>dropout</strong> – whether to use mc-dropout estimation together
with SWAG when sampling</p></li>
<li><p><strong>prediction_key</strong> – if the model returns a dict, this specifices
which key contains its predictions; uncertainty will be computed
using the contents of this key. Must be provided if the model
returns a dict, otherwise ignored.</p></li>
<li><p><strong>max_unreduced_minibatches</strong> – the maximum number of minibatches whose
samples to keep in memory before reducing to compute mean
and standard deviation. Runs faster for larger values but
takes more memory. If not provided, we accumulate samples
for the whole dataloader before reducing.</p></li>
<li><p><strong>device</strong> – device on which the model lives. Only
needed for the batchnorm update step, ignored if
this doesn’t happen. “cpu” by default.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mean and standard deviation of the predictive distribution for
the examples contained in <code class="code docutils literal notranslate"><span class="pre">dataloader</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="afterglow.trackers.trackers.SWAGTracker.predictive_samples">
<span class="sig-name descname"><span class="pre">predictive_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pydantic.types.StrictInt</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../_modules/afterglow/trackers/trackers.html#SWAGTracker.predictive_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#afterglow.trackers.trackers.SWAGTracker.predictive_samples" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Produce samples from the model’s output distribution given</dt><dd><p>inputs <code class="code docutils literal notranslate"><span class="pre">args</span></code> and <code class="code docutils literal notranslate"><span class="pre">kwargs</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – positional arguments to pass to the model</p></li>
<li><p><strong>**kwargs</strong> – keyword arguments to pass to the model</p></li>
<li><p><strong>num_samples</strong> – number of samples to draw</p></li>
<li><p><strong>dropout</strong> – whether to use mc-dropout estimation together
with SWAG when sampling</p></li>
<li><p><strong>device</strong> – device on which the model lives. Only
needed for the batchnorm update step, ignored if
this doesn’t happen. “cpu” by default.</p></li>
<li><p><strong>Returns</strong> – list of samples from the predictive distribution</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="afterglow.trackers.trackers.SWAGTracker.predictive_samples_on_dataloader">
<span class="sig-name descname"><span class="pre">predictive_samples_on_dataloader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.utils.data.dataloader.DataLoader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pydantic.types.StrictInt</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_key</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../_modules/afterglow/trackers/trackers.html#SWAGTracker.predictive_samples_on_dataloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#afterglow.trackers.trackers.SWAGTracker.predictive_samples_on_dataloader" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce samples from the model’s output distribution on
the examples contained in <code class="code docutils literal notranslate"><span class="pre">dataloader</span></code>. We assume that dataloader
returns (input_batch, label_batch) tuples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataloader</strong> – contains the examples to sample from the output
distribution on</p></li>
<li><p><strong>num_samples</strong> – number of samples to draw</p></li>
<li><p><strong>dropout</strong> – whether to use mc-dropout estimation together
with SWAG when sampling</p></li>
<li><p><strong>prediction_key</strong> – if the model returns a dict, this specifices
which key contains its predictions; uncertainty will be computed
using the contents of this key. Must be provided if the model
returns a dict, otherwise ignored.</p></li>
<li><p><strong>device</strong> – device on which the model lives.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of samples from the predictive distribution</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="afterglow.trackers.trackers.SWAGTracker.sample_state">
<span class="sig-name descname"><span class="pre">sample_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/afterglow/trackers/trackers.html#SWAGTracker.sample_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#afterglow.trackers.trackers.SWAGTracker.sample_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the state of the tracker’s <code class="code docutils literal notranslate"><span class="pre">module</span></code> with a sample from
the estimated distribution over parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>device</strong> – where to send the data duing batchnorm update. Ignored
if we don’t do batchnorm update.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="afterglow.trackers.trackers.SWAGTracker.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.9)"><span class="pre">pathlib.Path</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/afterglow/trackers/trackers.html#SWAGTracker.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#afterglow.trackers.trackers.SWAGTracker.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the uncertainty-enabled model so that it can be
loaded using <code class="code docutils literal notranslate"><span class="pre">afterglow.load_swag_checkpoint</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> – where to save the checkpoint</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-afterglow.trackers">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-afterglow.trackers" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="enable.html" class="btn btn-neutral float-left" title="afterglow.enable" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Francesco Farina, Lawrence Phillips.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>